<html>
<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head>
<body>

<hr>
First, you'll need to load a dataset.
<br/>

<input id="dataset" value="TerminalBigraph"/>
<button type="button" onclick="loadDataset()">Load dataset</button>
<br/>

<textarea id="dataset-display" rows="12" cols="60"></textarea>

<hr>
Next, specify a translation with the same source.
<br/>

<input id="translation" value="ReverseGraph"/> 
<button type="button" onclick="loadTranslation()">Load translation</button>
<br/>

<textarea id="translation-display" rows="12" cols="60"></textarea>

<hr>
Finally, you can ask the server to compute any of the following data migration functors:<br/>
<button type="button" onclick="compute('pullback')">the pullback</button>
<button type="button" onclick="compute('leftPushforward')">the left pushforward</button>
<button type="button" onclick="compute('rightPushforward')">the right pushforward</button>
<br/>

<textarea id="result" rows="30" cols="120"></textarea>

<script>
function prettyPrint(json) {
	return JSON.stringify(json, undefined, 2);
}
</script>

<script>
var translation;
var dataset;
</script>

<script>
function loadDataset() {
$.ajax({
        beforeSend: function(req) {
                req.setRequestHeader("Accept", "application/json");
            },
        type:"GET",
        url: "/metaphor/examples/datasets/" + $("#dataset").val(),
        success: function(data){
	   dataset = data;
            $("#dataset-display").val(prettyPrint(data)); 
        }
        });
}
</script>

<script>
function loadTranslation() {
$.ajax({
        beforeSend: function(req) {
                req.setRequestHeader("Accept", "application/json");
            },
        type:"GET",
        url: "/metaphor/examples/translations/" + $("#translation").val(),
        success: function(data){
	    translation = data
            $("#translation-display").val(prettyPrint(data));  
        }
        });
}
</script>

<script>
function compute(datafunctor) {
$.ajax({
	type: "GET",
	url: "/metaphor/compute/" + datafunctor,
	data: { "translation": $("#translation-display").val(), "dataset": $("#dataset-display").val() },
	success: function(data){
		$("#result").val(prettyPrint(data));
	},
	error:function (xhr, ajaxOptions, thrownError){
                    alert("An error occurred on the server. Response code " + xhr.status + ". " + thrownError);
        }    
	});
}
</script>


</body>
</html>

